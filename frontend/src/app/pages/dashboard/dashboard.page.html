<ion-header [translucent]="true" class="app-header">
  <ion-toolbar>
    <ion-title>Home</ion-title>
    <ion-buttons slot="end">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="false" class="dashboard app-content">
  <div class="page page-shell">
    <div class="month-summary-card">
      <div class="section-top-row">
        <div class="small-label">{{ monthLabel }}</div>
        <ion-icon name="calendar-outline"></ion-icon>
      </div>
      <div class="big-title">Total transactions</div>
      <div class="total-value">{{ monthlyTransactionTotal | currency:selectedCurrencyCode:'symbol':'1.0-0' }}</div>

      <ion-searchbar
        class="tx-search"
        mode="ios"
        placeholder="Search transaction"
        [value]="searchTerm"
        (ionInput)="onSearchChange($event)"
        show-clear-button="focus"
      ></ion-searchbar>
    </div>

    <div class="section-header">
      <div class="section-title">My Wallets</div>
    </div>

    <div class="wallet-list" *ngIf="jars.length > 0; else emptyWallets">
      <div class="wallet-card" *ngFor="let jar of jars; let i = index">
        <div class="wallet-head">
          <div class="wallet-icon" [class.alt]="i % 2 === 1">
            <ion-icon [name]="i % 2 === 0 ? 'wallet-outline' : 'card-outline'"></ion-icon>
          </div>
          <div class="wallet-name">{{ jar.name }}</div>
        </div>
        <div class="wallet-balance">{{ jar.balance | currency:selectedCurrencyCode:'symbol':'1.0-0' }}</div>
        <div class="wallet-progress">
          <span [style.width.%]="getWalletProgress(jar)"></span>
        </div>
      </div>
    </div>
    <ng-template #emptyWallets>
      <div class="empty-card">No wallets yet.</div>
    </ng-template>

    <div class="section-header">
      <div class="section-title">Report this month</div>
    </div>

    <div class="report-card">
      <div class="report-chart">
        <div class="report-group">
          <div class="bar-track">
            <span class="bar income" [style.height.%]="incomeBarHeight"></span>
          </div>
          <div class="bar-label">Income</div>
          <div class="bar-value">{{ monthlyIncomeTotal | currency:selectedCurrencyCode:'symbol':'1.0-0' }}</div>
        </div>

        <div class="report-group">
          <div class="bar-track">
            <span class="bar expense" [style.height.%]="expenseBarHeight"></span>
          </div>
          <div class="bar-label">Spent</div>
          <div class="bar-value">{{ monthlyExpenseTotal | currency:selectedCurrencyCode:'symbol':'1.0-0' }}</div>
        </div>
      </div>
    </div>

    <div class="section-header">
      <div class="section-title">Recent transactions</div>
      <div class="tx-count">{{ filteredTransactions.length }}</div>
    </div>

    <div class="transaction-list" *ngIf="filteredTransactions.length > 0; else emptyTransactions">
      <div class="transaction-card" *ngFor="let tx of filteredTransactions; trackBy: trackByTransactionId">
        <div class="tx-icon" [class.income]="tx.type === 'income'" [class.expense]="tx.type === 'expense'">
          <ion-icon [name]="tx.icon"></ion-icon>
        </div>
        <div class="tx-meta">
          <div class="tx-title">{{ tx.title }}</div>
          <div class="tx-sub">{{ tx.jarName }} â€¢ {{ tx.timeLabel }}</div>
        </div>
        <div class="tx-amount" [class.income]="tx.type === 'income'" [class.expense]="tx.type === 'expense'">
          {{ tx.amount | currency:selectedCurrencyCode:'symbol':'1.0-0' }}
        </div>
      </div>
    </div>
    <ng-template #emptyTransactions>
      <div class="empty-card">No transactions match your search.</div>
    </ng-template>
  </div>

</ion-content>
